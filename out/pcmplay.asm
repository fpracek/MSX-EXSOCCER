;--------------------------------------------------------
; File Created by SDCC : free open source ANSI-C Compiler
; Version 4.2.0 #13081 (MINGW64)
;--------------------------------------------------------
	.module pcmplay
	.optsdcc -mz80
	
;--------------------------------------------------------
; Public variables in this module
;--------------------------------------------------------
	.globl _PCM_Play
;--------------------------------------------------------
; special function registers
;--------------------------------------------------------
_g_PortPrimarySlot	=	0x00a8
_g_PortReadKeyboard	=	0x00a9
_g_PortAccessKeyboard	=	0x00aa
_g_PortControl	=	0x00ab
_g_VDP_DataPort	=	0x0098
_g_VDP_RegPort	=	0x0099
_g_VDP_AddrPort	=	0x0099
_g_VDP_StatPort	=	0x0099
_g_PSG_RegPort	=	0x00a0
_g_PSG_DataPort	=	0x00a1
_g_PSG_StatPort	=	0x00a2
_g_PSG_Ext_RegPort	=	0x0010
_g_PSG_Ext_DataPort	=	0x0011
_g_PSG_Ext_StatPort	=	0x0012
_g_MSXMusic_IndexPort	=	0x007c
_g_MSXMusic_DataPort	=	0x007d
_g_MSXAudio_IndexPort	=	0x00c0
_g_MSXAudio_DataPort	=	0x00c1
_g_MSXAudio_IndexPort2	=	0x00c2
_g_MSXAudio_DataPort2	=	0x00c3
_g_RTC_AddrPort	=	0x00b4
_g_RTC_DataPort	=	0x00b5
;--------------------------------------------------------
; ram data
;--------------------------------------------------------
	.area _DATA
;--------------------------------------------------------
; ram data
;--------------------------------------------------------
	.area _INITIALIZED
;--------------------------------------------------------
; absolute external ram data
;--------------------------------------------------------
	.area _DABS (ABS)
;--------------------------------------------------------
; global & static initialisations
;--------------------------------------------------------
	.area _HOME
	.area _GSINIT
	.area _GSFINAL
	.area _GSINIT
;--------------------------------------------------------
; Home
;--------------------------------------------------------
	.area _HOME
	.area _HOME
;--------------------------------------------------------
; code
;--------------------------------------------------------
	.area _CODE
;E:\Dropbox\FAUSTO\SVILUPPI\MSX\CODE\C\MSXgl\engine/src/pcm/pcmplay.c:65: void PCM_Play(void* addr, u16 size)
;	---------------------------------
; Function PCM_Play
; ---------------------------------
_PCM_Play::
;E:\Dropbox\FAUSTO\SVILUPPI\MSX\CODE\C\MSXgl\engine/src/pcm/pcmplay.c:239: __endasm;
	GICINI	= 0x0090
	WRTPSG	= 0x0093
	RDPSG	= 0x0096
	PCMPLAY:
	di
	exx
	call	GICINI
	xor	a
	ld	e, a
	ld	b, #6
	PCMPLAY_TONERESET:
	call	WRTPSG
	inc	a
	djnz	PCMPLAY_TONERESET
	ld	c, #0xA1
	ld	d, #0
	exx
	PCMPLAY_LOOP:
	ld	a, (hl)
	inc	hl
	exx
	ld	e, a
	ld	hl, #PCMPLAY_SAMPLE_TABLE
	add	hl, de
	ld	b, (hl)
	inc	h
	ld	e, (hl)
	inc	h
	ld	h, (hl)
	ld	a, #8
	out	(0xA0), a
	out	(c), b
	inc	a
	out	(0xA0), a
	out	(c), e
	inc	a
	out	(0xA0), a
	out	(c), h
	ld	b, #16
	PCMPLAY_WAITLOOP:
	djnz	PCMPLAY_WAITLOOP
	exx
	dec	de
	ld	a, d
	or	e
	jp	nz, PCMPLAY_LOOP
	ei
	ret
	PCMPLAY_SAMPLE_TABLE:
	.db	00,01,02,03,04,03,05,03,04,05,06,06,05,06,06,06
	.db	06,06,07,06,07,08,08,08,07,07,09,07,09,09,08,08
	.db	09,09,08,09,09,09,09,09,10,10,10,10,09,09,10,10
	.db	10,10,09,10,11,11,11,11,11,11,11,11,10,10,10,11
	.db	11,11,11,11,11,11,11,12,11,11,12,12,11,12,11,12
	.db	12,12,12,11,12,11,12,12,12,12,11,12,12,12,12,11
	.db	12,13,12,13,11,13,13,13,13,13,13,11,13,13,13,13
	.db	13,13,13,12,13,13,13,12,12,13,12,13,13,13,13,13
	.db	13,12,13,13,13,13,13,13,13,14,13,13,14,14,14,14
	.db	14,14,13,14,14,13,14,14,14,14,14,14,13,14,14,14
	.db	14,14,14,13,14,14,13,14,14,13,13,14,14,14,14,14
	.db	14,14,14,14,13,14,14,13,14,14,14,14,14,14,13,14
	.db	14,14,15,14,15,15,15,15,15,15,15,15,15,15,15,15
	.db	14,15,15,15,15,15,15,14,15,15,15,15,15,15,15,15
	.db	15,15,15,15,15,15,15,15,15,15,15,14,15,14,14,14
	.db	14,14,15,15,14,15,15,14,15,15,15,15,15,15,15,14
	.db	00,00,00,00,00,02,00,02,02,03,01,02,04,04,03,04
	.db	04,05,04,05,05,02,03,04,06,06,01,06,02,03,06,07
	.db	05,06,07,06,06,06,07,06,04,04,05,06,08,07,06,06
	.db	07,06,08,07,03,04,03,04,04,05,05,05,08,09,09,07
	.db	07,07,08,07,08,08,08,02,08,09,03,05,09,05,08,06
	.db	06,07,06,10,07,09,08,07,08,08,09,08,08,09,08,10
	.db	09,00,08,01,10,02,03,04,04,05,06,10,06,06,06,07
	.db	06,07,07,10,08,08,07,11,11,08,11,08,09,09,09,08
	.db	09,11,09,09,10,10,10,10,10,00,10,09,02,02,04,03
	.db	04,04,11,05,05,11,07,07,07,07,07,08,10,08,08,08
	.db	08,08,09,11,09,09,12,08,09,12,11,09,10,10,09,10
	.db	10,10,10,09,11,10,10,12,10,10,11,11,11,10,12,11
	.db	11,11,00,11,01,02,03,04,03,04,04,05,05,05,06,07
	.db	12,07,07,07,08,07,08,12,08,08,08,09,08,09,09,09
	.db	08,09,09,09,09,10,10,09,10,10,10,13,09,13,13,13
	.db	13,13,10,11,13,11,10,13,11,11,11,11,11,10,10,12
	.db	00,00,00,00,00,00,00,01,01,00,00,00,01,00,02,02
	.db	03,02,01,04,01,01,01,01,03,04,00,05,01,01,04,01
	.db	01,00,04,02,03,04,01,05,01,02,01,00,02,06,03,04
	.db	01,05,06,04,00,00,02,02,03,02,03,04,06,02,03,02
	.db	03,04,00,05,02,03,04,00,05,00,02,00,03,02,07,01
	.db	02,00,04,00,03,07,00,05,02,03,08,04,05,00,06,07
	.db	03,00,07,00,08,01,01,01,02,01,00,09,02,03,04,01
	.db	05,03,04,07,01,02,06,01,02,05,04,06,02,03,04,07
	.db	05,07,06,06,00,01,02,03,04,00,05,08,00,01,00,02
	.db	02,03,00,03,04,03,00,01,02,03,04,00,09,02,03,04
	.db	04,05,00,08,02,03,00,07,05,03,09,06,00,01,07,03
	.db	04,04,05,08,10,06,06,08,07,07,00,00,01,08,09,04
	.db	05,05,00,06,00,00,00,00,02,02,03,02,03,04,03,00
	.db	01,02,03,04,00,05,02,06,04,04,05,00,06,02,03,04
	.db	07,05,05,06,06,00,01,07,03,04,04,00,08,02,03,04
	.db	04,05,07,00,06,01,08,07,04,05,05,06,06,09,09,11
;E:\Dropbox\FAUSTO\SVILUPPI\MSX\CODE\C\MSXgl\engine/src/pcm/pcmplay.c:240: }
	ret
	.area _CODE
	.area _INITIALIZER
	.area _CABS (ABS)
